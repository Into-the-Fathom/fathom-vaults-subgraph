specVersion: 0.0.2
description: FathomVault
repository: https://github.com/into-the-fathom/fathom-vaults-subgraph
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: FathomVault
    network: mainnet
    source:
      abi: FathomVault
      address: "{{FathomVault}}"
      startBlock: {{blockNumber}}
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.3
      language: wasm/assemblyscript
      file: ./src/mappings/vaultMappings.ts
      entities:
        - Transaction
        - Token
        - Vault
        - VaultUpdate
        - Account
        - Deposit
        - Withdraw
        - Transfer
        - AccountVaultPosition
        - AccountVaultPositionUpdate
        - Strategy
        - StrategyReport
        - StrategyReportResult
        - VaultDayData
      abis:
        - name: FathomVault
          file: ./abis/FathomVault.json
      eventHandlers:
        - event: RoleSet(indexed address,bytes32)
          handler: handleRoleSet
        - event: UpdateRoleManager(indexed address)
          handler: handleUpdateRoleManager
        - event: DebtPurchased(indexed address,uint256)
          handler: handleDebtPurchased
  - kind: ethereum/contract
    name: StrategyManager
    network: mainnet
    source:
      abi: StrategyManager
      address: "{{StrategyManager}}" # Replace with the actual address variable
      startBlock: {{blockNumber}} # Replace with the appropriate start block
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.3
      language: wasm/assemblyscript
      file: ./src/mappings/strategyManagerMappings.ts
      entities:
        - Strategy
        - StrategyReport
        - StrategyReportResult
        - Transaction
      abis:
        - name: StrategyManager
          file: ./abis/StrategyManager.json
        - name: FathomVault
          file: ./abis/FathomVault.json
        - name: SharesManager
          file: ./abis/SharesManager.json
      eventHandlers:
        - event: StrategyChanged(indexed address,uint8)
          handler: handleStrategyChanged
        - event: StrategyReported(indexed address,uint256,uint256,uint256,uint256,uint256,uint256)
          handler: handleStrategyReported
        - event: UpdatedMaxDebtForStrategy(indexed address,indexed address,uint256)
          handler: handleUpdatedMaxDebtForStrategy
        - event: DebtUpdated(indexed address,uint256,uint256)
          handler: handleDebtUpdated
        - event: UpdatedFees(indexed uint256,indexed uint256,indexed uint256,address)
          handler: handleUpdatedFees
  - kind: ethereum/contract
    name: SharesManager
    network: mainnet
    source:
      abi: SharesManager
      address: "{{SharesManager}}" # Replace with the actual address variable
      startBlock: {{blockNumber}} # Replace with the appropriate start block
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.3
      language: wasm/assemblyscript
      file: ./src/mappings/sharesManagerMappings.ts
      entities:
        - Strategy
        - Transaction
        - Vault
      abis:
        - name: SharesManager
          file: ./abis/SharesManager.json
        - name: FathomVault
          file: ./abis/FathomVault.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
        - event: Deposit(indexed address,indexed address,uint256,uint256)
          handler: handleDeposit
        - event: Withdraw(indexed address,indexed address,indexed address,uint256,uint256)
          handler: handleWithdraw
        - event: DebtUpdated(indexed address,uint256,uint256)
          handler: handleDebtUpdated
        - event: UpdateDepositLimit(uint256)
          handler: handleUpdateDepositLimit
  - kind: ethereum/contract
    name: Governance
    network: mainnet
    source:
      abi: Governance
      address: "{{Governance}}" # Replace with the actual address variable
      startBlock: {{blockNumber}} # Replace with the appropriate start block
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.3
      language: wasm/assemblyscript
      file: ./src/mappings/governanceMappings.ts
      entities:
        - Transaction
        - Vault
      abis:
        - name: Governance
          file: ./abis/Governance.json
        - name: FathomVault
          file: ./abis/FathomVault.json
      eventHandlers:
        - event: DebtPurchased(indexed address,uint256)
          handler: handleDebtPurchased
        - event: Shutdown()
          handler: handleShutdown
        - event: UpdateDepositLimitModule(indexed address)
          handler: handleUpdateDepositLimitModule
        - event: DebtUpdated(indexed address,uint256,uint256)
          handler: handleDebtUpdated
        - event: UpdateDepositLimit(uint256)
          handler: handleUpdateDepositLimit
  - kind: ethereum/contract
    name: Setters
    network: mainnet
    source:
      abi: Setters
      address: "{{Setters}}" # Replace with the actual address variable
      startBlock: {{blockNumber}} # Replace with the appropriate start block
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.3
      language: wasm/assemblyscript
      file: ./src/mappings/settersMappings.ts
      entities:
        - Transaction
        - Vault
      abis:
        - name: Setters
          file: ./abis/Setters.json
        - name: FathomVault
          file: ./abis/FathomVault.json
      eventHandlers:
        - event: UpdateAccountant(indexed address)
          handler: handleUpdateAccountant
        - event: UpdateDefaultQueue(address[])
          handler: handleUpdateDefaultQueue
        - event: UpdateUseDefaultQueue(bool)
          handler: handleUpdateUseDefaultQueue
        - event: UpdateDepositLimit(uint256)
          handler: handleUpdateDepositLimit
        - event: UpdateDepositLimitModule(indexed address)
          handler: handleUpdateDepositLimitModule
        - event: UpdateWithdrawLimitModule(indexed address)
          handler: handleUpdateWithdrawLimitModule
        - event: UpdateMinimumTotalIdle(uint256)
          handler: handleUpdateMinimumTotalIdle
        - event: UpdateProfitMaxUnlockTime(uint256)
          handler: handleUpdateProfitMaxUnlockTime

templates:
  - kind: ethereum/contract
    name: FathomVault
    network: mainnet
    source:
      abi: FathomVault
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.3
      language: wasm/assemblyscript
      file: ./src/mappings/vaultMappings.ts
      entities:
        - Transaction
        - Token
        - Vault
        - VaultUpdate
        - Account
        - Deposit
        - Withdraw
        - Transfer
        - AccountVaultPosition
        - AccountVaultPositionUpdate
        - Strategy
        - StrategyReport
        - StrategyReportResult
        - VaultDayData
      abis:
        - name: FathomVault
          file: ./abis/FathomVault.json
      eventHandlers:
        - event: DebtUpdated(indexed address,uint256,uint256)
          handler: handleDebtUpdated
        - event: RoleSet(indexed address,bytes32)
          handler: handleRoleSet
        - event: UpdateRoleManager(indexed address)
          handler: handleUpdateRoleManager
        - event: UpdateAccountant(indexed address)
          handler: handleUpdateAccountant
        - event: UpdateDefaultQueue(address[])
          handler: handleUpdateDefaultQueue
        - event: UpdateUseDefaultQueue(bool)
          handler: handleUpdateUseDefaultQueue
        - event: UpdatedMaxDebtForStrategy(indexed address,indexed address,uint256)
          handler: handleUpdatedMaxDebtForStrategy
        - event: UpdateDepositLimit(uint256)
          handler: handleUpdateDepositLimit
        - event: UpdateMinimumTotalIdle(uint256)
          handler: handleUpdateMinimumTotalIdle
        - event: UpdateProfitMaxUnlockTime(uint256)
          handler: handleUpdateProfitMaxUnlockTime
        - event: DebtPurchased(indexed address,uint256)
          handler: handleDebtPurchased
        - event: Shutdown()
          handler: handleShutdown
        - event: UpdateDepositLimitModule(indexed address)
          handler: handleUpdateDepositLimitModule
        - event: UpdateWithdrawLimitModule(indexed address)
          handler: handleUpdateWithdrawLimitModule
